---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
plot(cars)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.


```{r}
library(ggplot2)
library(wordcloud2)
library(tm)
df <- read.csv('/Users/snehalphatangare/Spring2018/CMPE256/Project/Hotel_Reviews.csv')
head(df)

```

```{r WordCloud}
library(ggplot2)
library(wordcloud2)
library(tm)
df <- read.csv('/Users/snehalphatangare/Spring2018/CMPE256/Project/Hotel_Reviews.csv')

reviews <- df[sample(nrow(df), 40000), ]
reviews <- reviews[reviews$Positive_Review!='No Positive',]
reviews <- reviews[reviews$Negative_Review!='No Negative',]
term_freq <- function(df,sent){
  if(sent=='pos'){
       corpus <- Corpus(VectorSource(df$Positive_Review))
  }else{
       corpus <- Corpus(VectorSource(df$Negative_Review))
  }
  corpus <- tm_map(corpus, removeWords, stopwords("SMART"))
  corpus <- tm_map(corpus, removeWords, stopwords("en"))
  corpus <- tm_map(corpus, stripWhitespace)
  dtm <-TermDocumentMatrix(corpus)
  mat_dtm <- as.matrix(dtm)
  v_dtm <- sort(rowSums(mat_dtm),decreasing = TRUE)
  FreqMat <- data.frame(word = names(v_dtm), Freq = v_dtm)
  FreqMat <- FreqMat[1:50,]
  
  return(FreqMat)
}

wordcloud2(data = term_freq(reviews,'pos'),minRotation = 0,maxRotation = 0)
```

```{r}
library(sqldf)
library(ggplot2)
library(wordcloud2)
library(tm)
df <- read.csv('/Users/snehalphatangare/Spring2018/CMPE256/Project/Hotel_Reviews.csv')
#hotelData <- sqldf('SELECT Positive_Review, Negative_Review,Hotel_Name from df where Hotel_Name="Apex Temple Court Hotel" ')
hotelName <- "The Principal London"
hotelData <- sqldf(sprintf('SELECT Positive_Review, Negative_Review,Hotel_Name from df where Hotel_Name="%s"',hotelName))
reviews <- hotelData
#result <- hotelData[1:3,]
#print(hotelData)

reviews <- reviews[reviews$Positive_Review!='No Positive',]
reviews <- reviews[reviews$Negative_Review!='No Negative',]
term_freq <- function(df,sent){
  if(sent=='pos'){
       corpus <- Corpus(VectorSource(df$Positive_Review))
  }else{
       corpus <- Corpus(VectorSource(df$Negative_Review))
  }
  #Clean the corpus
  #Remove punctuation
  corpus <- tm_map(corpus, removePunctuation)
  # Convert corpus to lowercase
  corpus <- tm_map(corpus, content_transformer(tolower))      
  corpus <- tm_map(corpus, removeWords, stopwords("SMART"))
  corpus <- tm_map(corpus, removeWords, stopwords("english"))
  # Remove our custom vector of stop words from corpus
  custom_stopwords <- c("the", "didn","can","could","couldn","couldnt","wasn","wasnt","also","use", "using","hotel","extremely","not","never","will","would","nice","excellent","good","perfect")
  corpus <- tm_map(corpus, removeWords, custom_stopwords)                   
                      
  corpus <- tm_map(corpus, stripWhitespace)
  dtm <-TermDocumentMatrix(corpus)
  mat_dtm <- as.matrix(dtm)
  v_dtm <- sort(rowSums(mat_dtm),decreasing = TRUE)
  FreqMat <- data.frame(word = names(v_dtm), Freq = v_dtm)
  FreqMat <- FreqMat[1:50,]
  
  return(FreqMat)
}

wordcloud2(data = term_freq(reviews,'pos'),minRotation = 0,maxRotation = 0)
#NEgative review
wordcloud2(data = term_freq(reviews,'neg'),minRotation = 0,maxRotation = 0)
```


